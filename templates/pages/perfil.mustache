{{< layout}}
{{$main}}
<script>
    const headerConfig = {
        navPrefix: '',
        userType: '',
        userId: null
    };
</script>
<main class="profile-page">
  <!-- PERFIL -->
  <section class="profile-card">
    <img src="https://i.pravatar.cc/80?img=32" class="avatar" alt="Avatar">
    <div class="profile-info">
      <h2>Rodrigo Silva</h2>
      <p>Fot√≥grafo Profissional Especializado em Casamentos e Eventos</p>
      <div class="meta">
        <span>‚≠ê 4.9 (127 avalia√ß√µes)</span>
        <span>Mirandela, Portugal</span>
      </div>
    </div>
    <button class="edit-btn" onclick="window.location.href='edit-profile.html'">Editar Perfil</button>
  </section>
  <!-- TABS -->
  <section class="tabs">
    <button class="tab-btn active" data-tab="portfolio">Portf√≥lio</button>
    <button class="tab-btn" data-tab="servicos">Servi√ßos</button>
    <button class="tab-btn" data-tab="avaliacoes">Avalia√ß√µes</button>
  </section>
  <!-- CONTE√öDO DAS TABS -->
  <section class="tab-content">
    <!-- PORTF√ìLIO -->
<div id="portfolio" class="tab-panel active">
  <button class="edit-btn" id="edit-portfolio-btn" data-edit="portfolio">
    Editar Portf√≥lio
  </button>

  <button class="edit-btn" id="add-portfolio-item"
    style="background:#eee; color:#7b0000; margin-left:12px; display:none;">
    Adicionar
  </button>

  <div style="display:flex; justify-content:center; background:#fcfaf7;
              border-radius:0 0 24px 24px; padding:32px 0;">
    <div class="portfolio portfolio-grid" id="portfolio-items"
         style="background:transparent; padding:0; border-radius:0;">
    </div>
  </div>
</div>

<script>
let portfolioEditMode = false;
const editBtn = document.getElementById('edit-portfolio-btn');
const addBtn = document.getElementById('add-portfolio-item');
const portfolioItems = document.getElementById('portfolio-items');

let portfolioData = [
  {img:'https://picsum.photos/400/400?1', nome:'Projeto 1', desc:'Descri√ß√£o 1'},
  {img:'https://picsum.photos/400/400?2', nome:'Projeto 2', desc:'Descri√ß√£o 2'},
  {img:'https://picsum.photos/400/400?3', nome:'Projeto 3', desc:'Descri√ß√£o 3'},
  {img:'https://picsum.photos/400/400?4', nome:'Projeto 4', desc:'Descri√ß√£o 4'},
  {img:'https://picsum.photos/400/400?5', nome:'Projeto 5', desc:'Descri√ß√£o 5'},
  {img:'https://picsum.photos/400/400?6', nome:'Projeto 6', desc:'Descri√ß√£o 6'}
];

function renderPortfolio() {
  portfolioItems.innerHTML = '';

  portfolioData.forEach((item, idx) => {
    const div = document.createElement('div');
    div.className = 'portfolio-item';
    div.style = 'position:relative; text-align:center;';

    if (portfolioEditMode) {
      div.innerHTML = `
        <div style="position:relative; display:inline-block; margin-bottom:16px;">
          <label style="cursor:pointer;">
            <input type="file" accept="image/*" style="display:none;"
                   data-idx="${idx}" class="portfolio-img-input">
            <img src="${item.img}">
          </label>

          <button type="button" class="delete-img-btn"
                  style="position:absolute; top:8px; right:8px;
                  background:#fff; border:none; border-radius:50%;
                  width:32px; height:32px; cursor:pointer;">
            üóë
          </button>
        </div>

        <input type="text" value="${item.nome}"
               class="portfolio-name"
               style="width:100%; margin:10px 0; padding:8px;
               border-radius:6px; border:1px solid #ccc;">

        <textarea class="portfolio-desc"
                  style="width:100%; padding:8px;
                  border-radius:6px; border:1px solid #ccc;">
          ${item.desc}
        </textarea>

        <button type="button" class="remove-portfolio-item"
                style="margin-top:8px;">
          Remover
        </button>
      `;

      div.querySelector('.delete-img-btn').onclick = () => {
        portfolioData.splice(idx, 1);
        renderPortfolio();
      };

      div.querySelector('.portfolio-img-input').onchange = function () {
        if (this.files[0]) {
          const reader = new FileReader();
          reader.onload = e => {
            portfolioData[idx].img = e.target.result;
            renderPortfolio();
          };
          reader.readAsDataURL(this.files[0]);
        }
      };

      div.querySelector('.portfolio-name').oninput =
        e => portfolioData[idx].nome = e.target.value;

      div.querySelector('.portfolio-desc').oninput =
        e => portfolioData[idx].desc = e.target.value;

      div.querySelector('.remove-portfolio-item').onclick = () => {
        portfolioData.splice(idx, 1);
        renderPortfolio();
      };

    } else {
      div.innerHTML = `<img src="${item.img}">`;
    }

    portfolioItems.appendChild(div);
  });
}

editBtn.onclick = () => {
  portfolioEditMode = !portfolioEditMode;
  addBtn.style.display = portfolioEditMode ? 'inline-block' : 'none';
  editBtn.textContent = portfolioEditMode
    ? 'Concluir Edi√ß√£o'
    : 'Editar Portf√≥lio';
  renderPortfolio();
};

addBtn.onclick = () => {
  portfolioData.push({
    img:'https://picsum.photos/400/400?random='+Math.random(),
    nome:'', desc:''
  });
  renderPortfolio();
};

window.addEventListener('DOMContentLoaded', () => {
  addBtn.style.display = 'none';
  renderPortfolio();
});
</script>

<style>

</style>
    <!-- SERVI√áOS -->
    <div id="servicos" class="tab-panel">
      <button class="edit-btn" data-edit="servicos">Editar Servi√ßos</button>
      <ul class="services">
        <li>üì∏ Casamentos</li>
        <li>üéâ Eventos</li>
        <li>üßë‚Äçüíº Retratos Profissionais</li>
        <li>üè¢ Fotografia Corporativa</li>
      </ul>
    </div>
    <!-- AVALIA√á√ïES -->
    <div id="avaliacoes" class="tab-panel">
      <div class="review">
        <p>Excelente profissional, super atento.</p>
        <span>‚Äî Ana Silva</span>
      </div>
      <div class="review">
        <p>Fotos incr√≠veis, recomendo.</p>
        <span>‚Äî Jo√£o Costa</span>
      </div>
    </div>
  </section>
    </main>
<script>
  // Altern√¢ncia de abas do perfil
  document.addEventListener('DOMContentLoaded', function() {
    const tabBtns = document.querySelectorAll('.tab-btn');
    const tabPanels = document.querySelectorAll('.tab-panel');
    tabBtns.forEach(btn => {
      btn.addEventListener('click', function() {
        // Remove ativo de todos os bot√µes e pain√©is
        tabBtns.forEach(b => b.classList.remove('active'));
        tabPanels.forEach(panel => panel.classList.remove('active'));
        // Ativa o bot√£o e painel correspondente
        btn.classList.add('active');
        const tab = btn.getAttribute('data-tab');
        document.getElementById(tab).classList.add('active');
      });
    });
  });
</script>

{{/main}}
{{/layout}}