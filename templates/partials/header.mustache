<link rel="stylesheet" href="/assets/css/styles.css">
<header class="header">
    <div class="logo">{{site.title}}</div>

    <nav class="nav">
        <a href="{{navPrefix}}index.html"{{#isHome}} class="active"{{/isHome}}>Inicial</a>
        <a href="{{navPrefix}}reserva.html"{{#isReserva}} class="active"{{/isReserva}}>Reservar</a>
        <a href="{{navPrefix}}mensagens.html"{{#isMensagens}} class="active"{{/isMensagens}}>Mensagens</a>
        <a href="{{navPrefix}}blog.html"{{#isBlog}} class="active"{{/isBlog}}>Blog</a>
        <a href="{{navPrefix}}about.html"{{#isAbout}} class="active"{{/isAbout}}>Sobre Nós</a>
    </nav>

    <div class="profile-menu-container" style="position: relative;">
        <button class="profile-btn" id="profile-btn" aria-label="Menu de Perfil" onclick="document.getElementById('profile-dropdown').classList.toggle('show')">
            <img src="https://i.pravatar.cc/64?img=12" alt="Perfil" class="profile-avatar">
        </button>
        <div class="profile-dropdown" id="profile-dropdown" style="display: none; position: absolute; right: 0; top: 100%; background: #fff; border: 1px solid #dbdbdb; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.12); min-width: 180px; z-index: 1000;">
                  
                  <button id="btn-logout" style="display: block; width: 100%; padding: 10px 16px; background: none; border: none; text-align: left; color: #ab2a2a; cursor: pointer;">Terminar Sessão</button>
                  {{^user.authenticated}}
                    <a href="{{navPrefix}}perfil.html" style="display: block; padding: 10px 16px; color: #262626; text-decoration: none;">Ver Perfil</a>
                    <a href="{{navPrefix}}registo.html" style="display: block; padding: 10px 16px; color: #262626; text-decoration: none;">Registar</a>
                    
                  {{/user.authenticated}}
                  {{#user.authenticated}}
                    <a href="#" id="ver-perfil-link" style="display: block; padding: 10px 16px; color: #262626; text-decoration: none;">Ver Perfil</a>
                    <hr style="margin: 0;">
                    <button id="btn-delete-account" style="display: block; width: 100%; padding: 10px 16px; background: none; border: none; text-align: left; color: #7b0000; cursor: pointer;">Apagar Conta</button>
                  {{/user.authenticated}}
        </div>
    </div>
    <script>
      document.addEventListener('click', function(event) {
        var dropdown = document.getElementById('profile-dropdown');
        var btn = document.getElementById('profile-btn');
        if (!btn.contains(event.target)) {
          dropdown.classList.remove('show');
          dropdown.style.display = 'none';
        } else {
          dropdown.style.display = dropdown.classList.contains('show') ? 'block' : 'none';
        }
      });

      // Terminar sessão com confirmação
      document.addEventListener('DOMContentLoaded', function() {
        var logoutBtn = document.getElementById('btn-logout');
        if (logoutBtn) {
          logoutBtn.addEventListener('click', function(e) {
            e.preventDefault();
            if (confirm('Tem a certeza que deseja terminar sessão?')) {
              // Aqui pode adicionar lógica para terminar sessão no backend se necessário
              window.location.href = '{{navPrefix}}registo.html';
            }
          });
        }
      });
    </script>
</header>

<script>
    const headerConfig = {
        navPrefix: '{{navPrefix}}',
        userType: '{{user.type}}',
        userId: {{#user.authenticated}}{{user.id}}{{/user.authenticated}}{{^user.authenticated}}null{{/user.authenticated}}
    };
</script>
<script src="{{headerJs}}"></script>